<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Special Raksha Bandhan Message</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* --- General Setup & Theming --- */
        :root {
            --bg-dark-start: #1a0b2e;
            --bg-dark-end: #0d122b;
            --neon-magenta: #ff00ff;
            --neon-cyan: #00ffff;
            --neon-gold: #ffd700;
            --neon-green: #39ff14;
            --whatsapp-green: #25D366;
            --text-light: #f0f0f0;
        }

        html, body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden; /* No scrolling */
            font-family: 'Poppins', 'Google Sans', sans-serif;
            background-color: var(--bg-dark-start);
            color: var(--text-light);
        }

        /* --- Main Containers --- */
        .screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            transition: opacity 1.5s ease-in-out;
        }

        /* --- Landing Screen (Before Reveal) --- */
        #landing-screen {
            background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
            background-size: 400% 400%;
            animation: gradient-shift 15s ease infinite;
            z-index: 100;
        }

        #landing-screen h1 {
            font-size: clamp(2.5rem, 8vw, 5rem);
            color: white;
            text-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
            animation: zoom-in-out 5s ease-in-out infinite;
            max-width: 90%;
        }

        .reveal-button {
            margin-top: 30px;
            padding: 15px 30px;
            font-size: clamp(1rem, 4vw, 1.5rem);
            font-weight: 600;
            color: white;
            background-color: transparent;
            border: 2px solid white;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 0 15px var(--neon-cyan), 0 0 30px var(--neon-cyan) inset;
            animation: neon-glow-pulse 2s infinite;
        }

        .reveal-button:hover {
            background-color: var(--neon-cyan);
            color: var(--bg-dark-end);
            box-shadow: 0 0 25px var(--neon-cyan), 0 0 50px var(--neon-cyan);
        }

        /* --- Celebration Screen --- */
        #celebration-screen {
            background: linear-gradient(135deg, var(--bg-dark-start), var(--bg-dark-end));
            opacity: 0;
            visibility: hidden;
            z-index: 50;
            justify-content: flex-start; /* Align content to the top */
            padding-top: 2vh;
            gap: 1vh; /* Spacing between elements */
            box-sizing: border-box;
            overflow-y: auto; /* Allow vertical scrolling if content overflows */
            padding-bottom: 3vh; /* Add padding to the bottom */
        }

        #celebration-screen.visible {
            opacity: 1;
            visibility: visible;
        }

        /* Canvas for animations */
        #celebration-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 51;
            pointer-events: none;
        }
        
        .content-wrapper {
            position: relative;
            z-index: 52;
            width: 100%;
            max-width: 600px; /* Control max content width on desktop */
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* Happy Raksha Bandhan Text */
        .header-text-container {
            position: relative;
            padding: 5px 20px;
            margin-bottom: -10px; /* Overlap with Rakhi image */
        }

        .header-text-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, var(--neon-magenta), var(--neon-cyan));
            filter: blur(25px);
            animation: gradient-shift 5s ease infinite alternate;
            z-index: -1;
        }

        #header-text {
            font-size: clamp(2rem, 8vw, 4rem);
            font-weight: 700;
            animation: disco-text 4s linear infinite, blink-soft 2s ease-in-out infinite;
        }
        
        /* Rakhi GIF Image */
        #rakhi-image {
            width: 90%;
            max-width: 280px;
            height: auto;
            border-radius: 20px;
            animation: pulse-alive 4s ease-in-out infinite, gradient-shadow 6s linear infinite;
        }

        /* Greeting Message */
        .greeting-container {
            margin-top: 2vh;
            padding: 15px;
            width: 90%;
            max-width: 500px;
            background-color: rgba(0,0,0,0.3);
            border-radius: 15px;
            position: relative;
        }
        
        .greeting-container::before {
            content: '';
            position: absolute;
            top: -2px; left: -2px; right: -2px; bottom: -2px;
            background: linear-gradient(45deg, var(--neon-gold), var(--neon-green));
            border-radius: 17px;
            filter: blur(15px);
            opacity: 0.7;
            z-index: -1;
            animation: gradient-shift 6s ease-in-out infinite;
        }

        #greeting-message {
            font-size: clamp(1.1rem, 4vw, 1.5rem);
            font-weight: 500;
            line-height: 1.5;
        }

        #sender-name {
            font-weight: 700;
            animation: color-changing-glow 4s linear infinite, blink-soft 2.5s ease-in-out infinite, subtle-zoom 5s ease-in-out infinite;
        }
        
        /* Input and Sharing Controls */
        .controls-container {
            margin-top: 2vh;
            display: flex;
            flex-direction: column;
            gap: 12px;
            width: 90%;
            max-width: 400px;
        }
        
        .input-field {
            width: 100%;
            padding: 12px;
            background-color: rgba(0, 0, 0, 0.4);
            border: 1px solid var(--neon-cyan);
            border-radius: 10px;
            color: var(--text-light);
            font-size: 1rem;
            box-sizing: border-box;
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.5) inset;
            transition: border-color 0.3s, box-shadow 0.3s;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--neon-magenta);
            box-shadow: 0 0 15px rgba(255, 0, 255, 0.7) inset, 0 0 10px rgba(255, 0, 255, 0.5);
        }
        
        textarea.input-field {
            resize: none;
            height: 60px;
        }
        
        .buttons-row {
            display: flex;
            gap: 10px;
            justify-content: center;
            width: 100%;
            margin-top: 1vh;
        }
        
        .action-button {
            flex: 1;
            padding: 12px;
            font-size: 1rem;
            font-weight: 600;
            border-radius: 10px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        /* Special Gift Button */
        .gift-button {
            background: linear-gradient(45deg, var(--neon-gold), #ff8c00);
            color: #333;
            animation: bounce-pulse 2s infinite;
            box-shadow: 0 0 10px var(--neon-gold), 0 0 20px #ff8c00;
            flex: 1.5; /* Make this button bigger */
        }
        .gift-button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px var(--neon-gold), 0 0 30px #ff8c00;
        }
        
        /* WhatsApp Share Button */
        .whatsapp-button {
            background-color: var(--whatsapp-green);
            color: white;
            box-shadow: 0 0 10px var(--whatsapp-green);
        }
        .whatsapp-button:hover {
            background-color: #2ce671;
            box-shadow: 0 0 20px var(--whatsapp-green);
            transform: scale(1.05);
        }

        /* --- Keyframe Animations --- */
        @keyframes gradient-shift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes zoom-in-out {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes neon-glow-pulse {
            0%, 100% { box-shadow: 0 0 15px var(--neon-cyan), 0 0 30px var(--neon-cyan) inset; }
            50% { box-shadow: 0 0 25px var(--neon-cyan), 0 0 40px var(--neon-cyan) inset; }
        }
        
        @keyframes disco-text {
            0%   { color: var(--neon-magenta); }
            25%  { color: var(--neon-cyan); }
            50%  { color: var(--neon-gold); }
            75%  { color: var(--neon-green); }
            100% { color: var(--neon-magenta); }
        }

        @keyframes blink-soft {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        @keyframes pulse-alive {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.03); }
        }
        
        @keyframes gradient-shadow {
            0%   { filter: drop-shadow(0px 10px 15px hsla(300, 100%, 50%, 0.4)); }
            25%  { filter: drop-shadow(0px 10px 15px hsla(180, 100%, 50%, 0.4)); }
            50%  { filter: drop-shadow(0px 10px 15px hsla(50, 100%, 50%, 0.4)); }
            75%  { filter: drop-shadow(0px 10px 15px hsla(90, 100%, 50%, 0.4)); }
            100% { filter: drop-shadow(0px 10px 15px hsla(300, 100%, 50%, 0.4)); }
        }
        
        @keyframes color-changing-glow {
            0%   { text-shadow: 0 0 8px var(--neon-magenta), 0 0 10px var(--neon-magenta); }
            25%  { text-shadow: 0 0 8px var(--neon-cyan), 0 0 10px var(--neon-cyan); }
            50%  { text-shadow: 0 0 8px var(--neon-gold), 0 0 10px var(--neon-gold); }
            75%  { text-shadow: 0 0 8px var(--neon-green), 0 0 10px var(--neon-green); }
            100% { text-shadow: 0 0 8px var(--neon-magenta), 0 0 10px var(--neon-magenta); }
        }
        
        @keyframes subtle-zoom {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }
        
        @keyframes bounce-pulse {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-5px) scale(1.03); }
        }

    </style>
</head>
<body>

    <!-- ======== Landing Screen ======== -->
    <div id="landing-screen" class="screen">
        <h1>Special Raksha Bandhan message waiting for you</h1>
        <button id="reveal-btn" class="reveal-button">Click to Reveal</button>
    </div>

    <!-- ======== Main Celebration Screen ======== -->
    <div id="celebration-screen" class="screen">
        <!-- Audio Player -->
        <audio id="bg-music" loop src="rakhi.mp3"></audio>
        
        <!-- Canvas for Animations -->
        <canvas id="celebration-canvas"></canvas>

        <div class="content-wrapper">
            <!-- Header Text -->
            <div class="header-text-container">
                <h2 id="header-text">Happy Raksha Bandhan</h2>
            </div>

            <!-- Rakhi GIF -->
            <img id="rakhi-image" src="rakhi.gif" alt="Animated Rakhi">

            <!-- Greeting Message -->
            <div class="greeting-container">
                <p id="greeting-message">
                    <span id="sender-name">Someone</span> ki taraf se: 
                    <span id="custom-message">aapko Raksha Bandhan ki bahut bahut badhai.</span>
                </p>
            </div>

            <!-- Input & Sharing Controls -->
            <div class="controls-container">
                <input type="text" id="name-input" class="input-field" placeholder="Enter your name">
                <textarea id="msg-input" class="input-field" placeholder="Type your message"></textarea>
                
                <div class="buttons-row">
                    <!-- 
                        üî•üî• PASTE YOUR AMAZON AFFILIATE LINK BELOW üî•üî•
                        Replace "YOUR_AFFILIATE_LINK" with your actual affiliate link.
                    -->
                    <a href="https://amzn.to/4fsxFxB" target="_blank" class="action-button gift-button">
                        üéÅ Special Gifts üëá
                    </a>

                    <a href="#" id="whatsapp-share-btn" class="action-button whatsapp-button">
                        <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512" fill="white"><path d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zM223.9 439.6c-33.8 0-66.3-8.8-94.3-25.2l-6.7-4-69.8 18.3L72 359.2l-4.5-7c-18.9-29.7-28.9-63.3-28.9-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5 0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8-3.7 5.6-14.3 18-17.6 21.8-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.7 1.4-14.8 6.9-5.1 5.6-19.4 19-19.4 46.3 0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"/></svg>
                        Share
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- Element Selection ---
        const revealBtn = document.getElementById('reveal-btn');
        const landingScreen = document.getElementById('landing-screen');
        const celebrationScreen = document.getElementById('celebration-screen');
        const bgMusic = document.getElementById('bg-music');
        const nameInput = document.getElementById('name-input');
        const msgInput = document.getElementById('msg-input');
        const senderNameEl = document.getElementById('sender-name');
        const customMessageEl = document.getElementById('custom-message');
        const whatsappShareBtn = document.getElementById('whatsapp-share-btn');
        
        // --- Animation Canvas Setup ---
        const canvas = document.getElementById('celebration-canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        // --- Web Audio API for Music Reactivity ---
        let audioContext, analyser, source, dataArray;
        let isAudioSetup = false;

        function setupAudioApi() {
            if (isAudioSetup) return;
            audioContext = new (window.AudioContext || window.webkitAudioContext)();
            analyser = audioContext.createAnalyser();
            source = audioContext.createMediaElementSource(bgMusic);
            
            source.connect(analyser);
            analyser.connect(audioContext.destination);
            
            analyser.fftSize = 128;
            const bufferLength = analyser.frequencyBinCount;
            dataArray = new Uint8Array(bufferLength);
            isAudioSetup = true;
        }

        // --- Particle Arrays ---
        let particles = [];
        let fallingObjects = [];

        // --- Event Listeners ---
        revealBtn.addEventListener('click', () => {
            // Ensure audio context is created on user interaction
            if (!isAudioSetup) {
                setupAudioApi();
            }
            audioContext.resume();

            // Play Music
            bgMusic.play().catch(error => console.error("Audio playback failed:", error));

            // Transition Screens
            landingScreen.style.opacity = '0';
            celebrationScreen.classList.add('visible');
            setTimeout(() => {
                landingScreen.style.display = 'none';
            }, 1500);

            // Start Animation Loop
            animate();
        });

        nameInput.addEventListener('input', updateGreeting);
        msgInput.addEventListener('input', updateGreeting);
        
        // --- Initialization on Page Load ---
        window.addEventListener('load', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const name = urlParams.get('name') || 'Someone';
            const msg = urlParams.get('msg') || 'aapko Raksha Bandhan ki bahut bahut badhai.';

            nameInput.value = name;
            msgInput.value = msg;
            
            updateGreeting();
        });

        // --- Core Functions ---
        function updateGreeting() {
            const name = nameInput.value.trim() || 'Someone';
            const msg = msgInput.value.trim() || 'aapko Raksha Bandhan ki bahut bahut badhai.';

            senderNameEl.textContent = name;
            customMessageEl.textContent = msg;

            updateWhatsappLink(name, msg);
        }

        function updateWhatsappLink(name, msg) {
            const currentUrl = window.location.origin + window.location.pathname;
            const pageLink = `${currentUrl}?name=${encodeURIComponent(name)}&msg=${encodeURIComponent(msg)}`;
            const whatsappText = `*${name} ki taraf se ek special Raksha Bandhan message for you!* üíå\n\n_"${msg}"_\n\nClick here to see your message: ${pageLink}`;
            whatsappShareBtn.href = `https://api.whatsapp.com/send?text=${encodeURIComponent(whatsappText)}`;
        }

        // --- Animation Classes and Logic ---
        const neonColors = ['#ff00ff', '#00ffff', '#ffd700', '#39ff14', '#ff5733'];
        const flowerEmojis = ['üå∫', 'üíê', 'ü•Ä', 'üåπ', 'üå∏', 'üåº', 'üåª', 'üåü'];

        class Particle {
            constructor(x, y, color) {
                this.x = x;
                this.y = y;
                this.color = color;
                this.size = Math.random() * 5 + 2;
                this.speedX = Math.random() * 3 - 1.5;
                this.speedY = Math.random() * 3 - 1.5;
                this.life = 100;
            }
            update() {
                this.x += this.speedX;
                this.y += this.speedY;
                this.life -= 1;
            }
            draw() {
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
        }
        
        class FallingObject {
             constructor() {
                this.x = Math.random() * canvas.width;
                this.y = -50;
                this.emoji = flowerEmojis[Math.floor(Math.random() * flowerEmojis.length)];
                this.size = Math.random() * 20 + 20;
                this.speedY = Math.random() * 1.5 + 1;
                this.sway = Math.random() * 2 - 1;
                this.rotation = 0;
                this.rotationSpeed = (Math.random() - 0.5) * 0.05;
             }
             update() {
                this.y += this.speedY;
                this.x += this.sway;
                this.rotation += this.rotationSpeed;
                if (this.x > canvas.width + 20 || this.x < -20) {
                   this.sway *= -1;
                }
             }
             draw() {
                ctx.save();
                ctx.translate(this.x, this.y);
                ctx.rotate(this.rotation);
                ctx.font = `${this.size}px Arial`;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(this.emoji, 0, 0);
                ctx.restore();
             }
        }
        
        class GlowingBalloon {
            constructor() {
                this.x = Math.random() * canvas.width;
                this.y = canvas.height + Math.random() * 100;
                this.size = Math.random() * 30 + 20;
                this.speedY = Math.random() * 1 + 0.5;
                this.color = neonColors[Math.floor(Math.random() * neonColors.length)];
                this.flicker = 1;
            }
            update() {
                this.y -= this.speedY;
                this.flicker = Math.random() * 0.4 + 0.6;
            }
            draw() {
                ctx.beginPath();
                ctx.fillStyle = this.color;
                ctx.globalAlpha = this.flicker;
                ctx.shadowColor = this.color;
                ctx.shadowBlur = 20;
                ctx.ellipse(this.x, this.y, this.size * 0.7, this.size, 0, 0, Math.PI * 2);
                ctx.fill();
                // string
                ctx.beginPath();
                ctx.moveTo(this.x, this.y + this.size);
                ctx.lineTo(this.x + (Math.random()*10 - 5), this.y + this.size + 30);
                ctx.strokeStyle = '#aaa';
                ctx.lineWidth = 1;
                ctx.stroke();

                ctx.shadowBlur = 0;
                ctx.globalAlpha = 1;
            }
        }

        function handleParticles(beatIntensity) {
            // Music-reactive confetti/sparkles
            if (beatIntensity > 150) { // Threshold for a "beat"
                 const burstAmount = Math.floor((beatIntensity - 150) / 10);
                 for (let i = 0; i < burstAmount; i++) {
                     const x = Math.random() * canvas.width;
                     const y = Math.random() * canvas.height;
                     const color = neonColors[Math.floor(Math.random() * neonColors.length)];
                     particles.push(new Particle(x, y, color));
                 }
            }
            
            // Update and draw existing particles
            for (let i = particles.length - 1; i >= 0; i--) {
                particles[i].update();
                particles[i].draw();
                if (particles[i].life < 0) {
                    particles.splice(i, 1);
                }
            }
        }

        function handleFallingObjects() {
            // Create new objects (reduced density)
            if (Math.random() < 0.025) { // 2.5% chance per frame
                if (Math.random() > 0.4) {
                    fallingObjects.push(new FallingObject());
                } else {
                    fallingObjects.push(new GlowingBalloon());
                }
            }
            
            // Update and draw
            for (let i = fallingObjects.length - 1; i >= 0; i--) {
                fallingObjects[i].update();
                fallingObjects[i].draw();
                // Remove if off-screen
                if (fallingObjects[i].y > canvas.height + 50 || fallingObjects[i].y < -150) {
                     fallingObjects.splice(i, 1);
                }
            }
        }

        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            let beatIntensity = 0;
            if (isAudioSetup) {
                analyser.getByteFrequencyData(dataArray);
                // Simple average of lower frequencies for beat detection
                for (let i = 0; i < dataArray.length / 4; i++) {
                    beatIntensity += dataArray[i];
                }
                beatIntensity /= (dataArray.length / 4);
            }
            
            handleParticles(beatIntensity);
            handleFallingObjects();
            
            requestAnimationFrame(animate);
        }
        
        // Adjust canvas size on window resize
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });

    </script>
</body>
</html>
